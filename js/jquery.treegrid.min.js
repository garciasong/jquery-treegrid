/*! jquery-treegrid 0.3.1 */
(function(d){var t={initTree:function(e){var t=d.extend({},this.treegrid.defaults,e);return this.each(function(){var e=d(this);e.treegrid("setTreeContainer",d(this));e.treegrid("setSettings",t);t.getRootNodes.apply(this,[d(this)]).treegrid("initNode",t);e.treegrid("getRootNodes").treegrid("render")})},initNode:function(t){return this.each(function(){var e=d(this);e.treegrid("setTreeContainer",t.getTreeGridContainer.apply(this));e.treegrid("getChildNodes").treegrid("initNode",t);e.treegrid("initExpander").treegrid("initIndent").treegrid("initEvents").treegrid("initState").treegrid("initChangeEvent").treegrid("initSettingsEvents")})},initChangeEvent:function(){var e=d(this);e.on("change",function(){var e=d(this);e.treegrid("render");if(e.treegrid("getSetting","saveState")){e.treegrid("saveState")}});return e},initEvents:function(){var e=d(this);e.on("collapse",function(){var e=d(this);e.removeClass("treegrid-expanded");e.addClass("treegrid-collapsed")});e.on("expand",function(){var e=d(this);e.removeClass("treegrid-collapsed");e.addClass("treegrid-expanded")});return e},initSettingsEvents:function(){var e=d(this);e.on("change",function(){var e=d(this);if(typeof e.treegrid("getSetting","onChange")==="function"){e.treegrid("getSetting","onChange").apply(e)}});e.on("collapse",function(){var e=d(this);if(typeof e.treegrid("getSetting","onCollapse")==="function"){e.treegrid("getSetting","onCollapse").apply(e)}});e.on("expand",function(){var e=d(this);if(typeof e.treegrid("getSetting","onExpand")==="function"){e.treegrid("getSetting","onExpand").apply(e)}});return e},initExpander:function(){var e=d(this);var t=e.find("td").get(e.treegrid("getSetting","treeColumn"));var r=e.treegrid("getSetting","expanderTemplate");var i=e.treegrid("getSetting","getExpander").apply(this);if(i){i.remove()}d(r).prependTo(t).click(function(){d(d(this).closest("tr")).treegrid("toggle")});return e},initIndent:function(){var e=d(this);e.find(".treegrid-indent").remove();var t=e.treegrid("getSetting","indentTemplate");var r=e.find(".treegrid-expander");var i=e.treegrid("getDepth");for(var n=0;n<i;n++){d(t).insertBefore(r)}return e},initState:function(){var e=d(this);if(e.treegrid("getSetting","saveState")&&!e.treegrid("isFirstInit")){e.treegrid("restoreState")}else{if(e.treegrid("getSetting","initialState")==="expanded"){e.treegrid("expand")}else{e.treegrid("collapse")}}return e},isFirstInit:function(){var e=d(this).treegrid("getTreeContainer");if(e.data("first_init")===undefined){e.data("first_init",d.cookie(e.treegrid("getSetting","saveStateName"))===undefined)}return e.data("first_init")},saveState:function(){var e=d(this);if(e.treegrid("getSetting","saveStateMethod")==="cookie"){var t=d.cookie(e.treegrid("getSetting","saveStateName"))||"";var r=t===""?[]:t.split(",");var i=e.treegrid("getNodeId");if(e.treegrid("isExpanded")){if(d.inArray(i,r)===-1){r.push(i)}}else if(e.treegrid("isCollapsed")){if(d.inArray(i,r)!==-1){r.splice(d.inArray(i,r),1)}}d.cookie(e.treegrid("getSetting","saveStateName"),r.join(","))}return e},restoreState:function(){var e=d(this);if(e.treegrid("getSetting","saveStateMethod")==="cookie"){var t=d.cookie(e.treegrid("getSetting","saveStateName")).split(",");if(d.inArray(e.treegrid("getNodeId"),t)!==-1){e.treegrid("expand")}else{e.treegrid("collapse")}}return e},getSetting:function(e){if(!d(this).treegrid("getTreeContainer")){return null}return d(this).treegrid("getTreeContainer").data("settings")[e]},setSettings:function(e){d(this).treegrid("getTreeContainer").data("settings",e)},getTreeContainer:function(){return d(this).data("treegrid")},setTreeContainer:function(e){return d(this).data("treegrid",e)},getRootNodes:function(){return d(this).treegrid("getSetting","getRootNodes").apply(this,[d(this).treegrid("getTreeContainer")])},getAllNodes:function(){return d(this).treegrid("getSetting","getAllNodes").apply(this,[d(this).treegrid("getTreeContainer")])},isNode:function(){return d(this).treegrid("getNodeId")!==null},getNodeId:function(){if(d(this).treegrid("getSetting","getNodeId")===null){return null}else{return d(this).treegrid("getSetting","getNodeId").apply(this)}},getParentNodeId:function(){return d(this).treegrid("getSetting","getParentNodeId").apply(this)},getParentNode:function(){if(d(this).treegrid("getParentNodeId")===null){return null}else{return d(this).treegrid("getSetting","getNodeById").apply(this,[d(this).treegrid("getParentNodeId"),d(this).treegrid("getTreeContainer")])}},getChildNodes:function(){return d(this).treegrid("getSetting","getChildNodes").apply(this,[d(this).treegrid("getNodeId"),d(this).treegrid("getTreeContainer")])},getDepth:function(){if(d(this).treegrid("getParentNode")===null){return 0}return d(this).treegrid("getParentNode").treegrid("getDepth")+1},isRoot:function(){return d(this).treegrid("getDepth")===0},isLeaf:function(){return d(this).treegrid("getChildNodes").length===0},isLast:function(){if(d(this).treegrid("isNode")){var e=d(this).treegrid("getParentNode");if(e===null){if(d(this).treegrid("getNodeId")===d(this).treegrid("getRootNodes").last().treegrid("getNodeId")){return true}}else{if(d(this).treegrid("getNodeId")===e.treegrid("getChildNodes").last().treegrid("getNodeId")){return true}}}return false},isFirst:function(){if(d(this).treegrid("isNode")){var e=d(this).treegrid("getParentNode");if(e===null){if(d(this).treegrid("getNodeId")===d(this).treegrid("getRootNodes").first().treegrid("getNodeId")){return true}}else{if(d(this).treegrid("getNodeId")===e.treegrid("getChildNodes").first().treegrid("getNodeId")){return true}}}return false},isExpanded:function(){return d(this).hasClass("treegrid-expanded")},isCollapsed:function(){return d(this).hasClass("treegrid-collapsed")},isOneOfParentsCollapsed:function(){var e=d(this);if(e.treegrid("isRoot")){return false}else{if(e.treegrid("getParentNode").treegrid("isCollapsed")){return true}else{return e.treegrid("getParentNode").treegrid("isOneOfParentsCollapsed")}}},expand:function(){if(!this.treegrid("isLeaf")&&!this.treegrid("isExpanded")){this.trigger("expand");this.trigger("change");return this}return this},expandAll:function(){var e=d(this);e.treegrid("getRootNodes").treegrid("expandRecursive");return e},expandRecursive:function(){return d(this).each(function(){var e=d(this);e.treegrid("expand");if(!e.treegrid("isLeaf")){e.treegrid("getChildNodes").treegrid("expandRecursive")}})},collapse:function(){return d(this).each(function(){var e=d(this);if(!e.treegrid("isLeaf")&&!e.treegrid("isCollapsed")){e.trigger("collapse");e.trigger("change")}})},collapseAll:function(){var e=d(this);e.treegrid("getRootNodes").treegrid("collapseRecursive");return e},collapseRecursive:function(){return d(this).each(function(){var e=d(this);e.treegrid("collapse");if(!e.treegrid("isLeaf")){e.treegrid("getChildNodes").treegrid("collapseRecursive")}})},toggle:function(){var e=d(this);if(e.treegrid("isExpanded")){e.treegrid("collapse")}else{e.treegrid("expand")}return e},render:function(){return d(this).each(function(){var e=d(this);if(e.treegrid("isOneOfParentsCollapsed")){e.hide()}else{e.show()}if(!e.treegrid("isLeaf")){e.treegrid("renderExpander");e.treegrid("getChildNodes").treegrid("render")}if(e.treegrid("isRoot")){e.addClass(e.treegrid("getSetting","expanderIsrootClass"))}})},renderExpander:function(){return d(this).each(function(){var e=d(this);var t=e.treegrid("getSetting","getExpander").apply(this);if(t){if(!e.treegrid("isCollapsed")){t.removeClass(e.treegrid("getSetting","expanderCollapsedClass"));t.addClass(e.treegrid("getSetting","expanderExpandedClass"))}else{t.removeClass(e.treegrid("getSetting","expanderExpandedClass"));t.addClass(e.treegrid("getSetting","expanderCollapsedClass"))}}else{e.treegrid("initExpander");e.treegrid("renderExpander")}})}};d.fn.treegrid=function(e){if(t[e]){return t[e].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof e==="object"||!e){return t.initTree.apply(this,arguments)}else{d.error("Method with name "+e+" does not exists for jQuery.treegrid")}};d.fn.treegrid.defaults={initialState:"expanded",saveState:false,saveStateMethod:"cookie",saveStateName:"tree-grid-state",expanderTemplate:'<span class="treegrid-expander"></span>',indentTemplate:'<span class="treegrid-indent"></span>',expanderExpandedClass:"treegrid-expander-expanded",expanderCollapsedClass:"treegrid-expander-collapsed",expanderIsrootClass:"treegrid-root",treeColumn:0,getExpander:function(){return d(this).find(".treegrid-expander")},getNodeId:function(){var e=/treegrid-([A-Za-z0-9_-]+)/;if(e.test(d(this).attr("class"))){return e.exec(d(this).attr("class"))[1]}return null},getParentNodeId:function(){var e=/treegrid-parent-([A-Za-z0-9_-]+)/;if(e.test(d(this).attr("class"))){return e.exec(d(this).attr("class"))[1]}return null},getNodeById:function(e,t){var r="treegrid-"+e;return t.find("tr."+r)},getChildNodes:function(e,t){var r="treegrid-parent-"+e;return t.find("tr."+r)},getTreeGridContainer:function(){return d(this).closest("table")},getRootNodes:function(e){var t=d.grep(e.find("tr"),function(e){var t=d(e).attr("class");var r=/treegrid-([A-Za-z0-9_-]+)/;var i=/treegrid-parent-([A-Za-z0-9_-]+)/;return r.test(t)&&!i.test(t)});return d(t)},getAllNodes:function(e){var t=d.grep(e.find("tr"),function(e){var t=d(e).attr("class");var r=/treegrid-([A-Za-z0-9_-]+)/;return r.test(t)});return d(t)},onCollapse:null,onExpand:null,onChange:null}})(jQuery);